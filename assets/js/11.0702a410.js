(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{293:function(t,a,e){"use strict";e.r(a);var s=e(0),v=Object(s.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h2",{attrs:{id:"dommasker"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#dommasker"}},[t._v("#")]),t._v(" DomMasker")]),t._v(" "),e("p",[t._v("处理当前 canvas 预设埋点及当前选中埋点的调度关系，其中使用了"),e("router-link",{attrs:{to:"/实现细节.html#双缓存机制解决蒙板闪烁问题"}},[t._v("双缓存策略")])],1),t._v(" "),e("h2",{attrs:{id:"事件上报模式整体流程"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#事件上报模式整体流程"}},[t._v("#")]),t._v(" 事件上报模式整体流程")]),t._v(" "),e("ol",[e("li",[t._v("监控到当前页面在iframe内，则开启埋点配置模式")]),t._v(" "),e("li",[t._v("当接收到父层iframe发过来的 "),e("code",[t._v("reset")]),t._v(" 指令，开启元素捕捉周期\n"),e("ul",[e("li",[t._v("开启原生应用的事件监听")]),t._v(" "),e("li",[t._v("开启 canvas")]),t._v(" "),e("li",[t._v("调用接口将当前该页面已经埋过的点拉取过来，绘制在 canvas 上")])])]),t._v(" "),e("li",[t._v("监控鼠标的移动，通过 event.target 找到当前移动到的元素，并生成元素标准格式对象（Point 实例），通过 canvas 绘制出其高亮区域")]),t._v(" "),e("li",[t._v("在鼠标移动的过程中点击元素，则将当前触发点击的元素通过 postMessage API 通知给iframe父层配置平台，生成配置信息用于展示")]),t._v(" "),e("li",[t._v("此时埋点配置模式进入惰性周期，不处理鼠标的移动或点击")]),t._v(" "),e("li",[t._v("当接收到父层iframe发过来的 "),e("code",[t._v("reset")]),t._v(" 指令，则重新开启鼠标事件监控，并重置之前的 canvas")])])])}),[],!1,null,null,null);a.default=v.exports}}]);