(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{291:function(t,e,a){"use strict";a.r(e);var r=a(0),s=Object(r.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"技术栈"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#技术栈"}},[t._v("#")]),t._v(" 技术栈")]),t._v(" "),a("p",[t._v("该项目使用到的技术栈 Typescript + inversify（IoC） + RxJS + Rollup + whats-element")]),t._v(" "),a("h4",{attrs:{id:"typescript"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#typescript"}},[t._v("#")]),t._v(" Typescript")]),t._v(" "),a("p",[t._v("sdk使用 ts 编写，利用其良好的静态类型检查，能够保证在开发阶段对一些常见错误进行规避，减少上线错误"),a("br"),t._v("\n一下提供几个 ts 的学习文档")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://zhongsp.gitbook.io/typescript-handbook/",target:"_blank",rel:"noopener noreferrer"}},[t._v("typescript-handbook"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://jkchao.github.io/typescript-book-chinese/",target:"_blank",rel:"noopener noreferrer"}},[t._v("深入理解 TypeScript 系列"),a("OutboundLink")],1)])]),t._v(" "),a("h4",{attrs:{id:"rxjs"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rxjs"}},[t._v("#")]),t._v(" RxJS")]),t._v(" "),a("p",[t._v("一个异步函数式库，使用到观察者模式和迭代器模式结合，项目中应用于对原生事件的监听、合并、组合、缓存等\n提供几个学习 RxJS 的比较完整的文章")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://juejin.im/post/5bc887ba6fb9a05d265991d5",target:"_blank",rel:"noopener noreferrer"}},[t._v("理解rx的一个形象的比喻"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://rxjs.dev/api",target:"_blank",rel:"noopener noreferrer"}},[t._v("rx官方的api文档"),a("OutboundLink")],1),t._v(" 很多操作符不知道什么意思的，可以在上面找的描述并且提供弹珠图")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://segmentfault.com/a/1190000015966781",target:"_blank",rel:"noopener noreferrer"}},[t._v("Rxjs 响应式编程"),a("OutboundLink")],1),t._v(" 学习 rx 的一个相对完整的教程")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://juejin.im/entry/5a4f30456fb9a01ca60299a0",target:"_blank",rel:"noopener noreferrer"}},[t._v("rxjs原理解析之自己造一个"),a("OutboundLink")],1),t._v(" rx作者写的关于rx原理的一个简单说明")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/xufei/blog/issues",target:"_blank",rel:"noopener noreferrer"}},[t._v("徐飞（teambition的开发者）的博客"),a("OutboundLink")],1),t._v(" teambition 中大量使用了 rx 做数据层，比较有应用价值")])]),t._v(" "),a("h4",{attrs:{id:"inversify"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#inversify"}},[t._v("#")]),t._v(" inversify")]),t._v(" "),a("p",[t._v("一种依赖注入库，依赖于 ts ，使用很方便，可以看看官方文档上的 "),a("a",{attrs:{href:"https://github.com/inversify/InversifyJS",target:"_blank",rel:"noopener noreferrer"}},[t._v("demo"),a("OutboundLink")],1)]),t._v(" "),a("h4",{attrs:{id:"whats-element"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#whats-element"}},[t._v("#")]),t._v(" whats-element")]),t._v(" "),a("p",[t._v("一个生成DOM元素唯一标识的库，"),a("a",{attrs:{href:"https://github.com/rowthan/whats-element",target:"_blank",rel:"noopener noreferrer"}},[t._v("源码"),a("OutboundLink")],1),t._v(" 很简单")]),t._v(" "),a("h2",{attrs:{id:"缓存索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#缓存索引"}},[t._v("#")]),t._v(" 缓存索引")]),t._v(" "),a("p",[t._v("数据上报的相关缓存，索引格式均为 "),a("code",[t._v("report_temp_[chunk:6]")])]),t._v(" "),a("h2",{attrs:{id:"控制台保存及警告打印规则"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#控制台保存及警告打印规则"}},[t._v("#")]),t._v(" 控制台保存及警告打印规则")]),t._v(" "),a("p",[t._v("任何打印注意添加 "),a("code",[t._v("[hx-analytics]")]),t._v(" 头作为标识，标识这是来自sdk的副作用")]),t._v(" "),a("p",[t._v("如：")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Error")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'[hx-analytics] - Error in change mode: ...'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("warn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("[hx-analytics] - Warn in report2Storage: ...")]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h2",{attrs:{id:"容器存取接口统一规则"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#容器存取接口统一规则"}},[t._v("#")]),t._v(" 容器存取接口统一规则")]),t._v(" "),a("p",[t._v("以下缓存容器均提供统一的数据存贮规则，存贮数据均为对象形式")]),t._v(" "),a("ul",[a("li",[t._v("window.name")]),t._v(" "),a("li",[t._v("localStorage")]),t._v(" "),a("li",[t._v("sessionStorage")]),t._v(" "),a("li",[t._v("AppConfig（只实现了其中的 "),a("code",[t._v("get")]),t._v(" / "),a("code",[t._v("set")]),t._v(" 接口，另外提供 "),a("code",[t._v("merge")]),t._v(" 接口）")])]),t._v(" "),a("p",[t._v("规则：")]),t._v(" "),a("h4",{attrs:{id:"get"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#get"}},[t._v("#")]),t._v(" get")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("@param")]),t._v(" key:string - 可选，表示想要获取数据的索引值，若不传则表示获取整个数据对象")]),t._v(" "),a("li",[a("code",[t._v("@return")]),t._v(" any - 若传入的了 key ，则可能返回任意数据类型（不存在则为undefined），若传入了 key 则为 Object 类型")])]),t._v(" "),a("h4",{attrs:{id:"set"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#set"}},[t._v("#")]),t._v(" set")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("@param")]),t._v(" key:string - 表示想要存贮的数据的索引，此处的清空会将数据集上的索引连同的清空掉"),a("br"),t._v("\n类似于 "),a("code",[t._v("delete xx")]),t._v(" 操作")]),t._v(" "),a("li",[a("code",[t._v("@return")]),t._v(" undefined")])]),t._v(" "),a("h4",{attrs:{id:"remove"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#remove"}},[t._v("#")]),t._v(" remove")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("@param")]),t._v(" key:string - 表示想要清空的数据的索引")]),t._v(" "),a("li",[a("code",[t._v("@param")]),t._v(" value:any - 表示想要存贮的数据的值")]),t._v(" "),a("li",[a("code",[t._v("@return")]),t._v(" undefined")])]),t._v(" "),a("h4",{attrs:{id:"clear"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#clear"}},[t._v("#")]),t._v(" clear")]),t._v(" "),a("p",[t._v("相当于清空整个存贮的数据集"),a("br"),t._v(" "),a("strong",[t._v("注意：这是危险操作！！若原生应用同样使用了数据集则可能导致原应用本身的错误")])]),t._v(" "),a("h2",{attrs:{id:"sdk数据上报测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sdk数据上报测试"}},[t._v("#")]),t._v(" sdk数据上报测试")]),t._v(" "),a("ol",[a("li",[t._v("基础行为\n"),a("ul",[a("li",[t._v("各行为事件（type=2）准确性验证")])])]),t._v(" "),a("li",[t._v("登录数据上报\n"),a("ul",[a("li",[t._v("登录事件上报（type=1）信息完整性验证")]),t._v(" "),a("li",[t._v("单窗口不可重复登录")])])]),t._v(" "),a("li",[t._v("单页页面切页数据完整性、正确性\n"),a("ul",[a("li",[t._v("进入页面时，上报进入页面事件")]),t._v(" "),a("li",[t._v("切页时（hash: path + hash，history: path），上报页面停留时长、进入下一页面、当前消息队列中缓存的事件")])])]),t._v(" "),a("li",[t._v("多页页面切页数据完整性、正确性\n"),a("ul",[a("li",[t._v("进入页面时，上报进入页面事件")])])]),t._v(" "),a("li",[t._v("页面进入、离开时（pageHide）数据完整性、正确性\n"),a("ul",[a("li",[t._v("支持 Beacon API，上报页面停留时长、当前消息队列中缓存的事件")]),t._v(" "),a("li",[t._v("不支持 Beacon API，将页面停留时长、当前消息队列等数据缓存至本地缓存")])])]),t._v(" "),a("li",[t._v("上报策略切换、上报失败数据处理\n"),a("ul",[a("li",[t._v("网络状态切换时，将切换上报策略（联网远程服务、断网本地缓存）")]),t._v(" "),a("li",[t._v("上报至远程服务失败时，应存贮进本地缓存，在下次访问页面时上报")])])]),t._v(" "),a("li",[t._v("跨域页面数据上报完整性、正确性（上一触点 + 行为）\n"),a("ul",[a("li",[t._v("支持 Beacon API，访问至跨域页面时，记录上一次行为的埋点（funcId）")]),t._v(" "),a("li",[t._v("不支持 Beacon API，访问至跨域页面时，上报上一页面缓存的行为，记录上一次行为的埋点（funcId）")])])]),t._v(" "),a("li",[t._v("页面前、后台切换的数据处理\n"),a("ul",[a("li",[t._v("切至前台\n"),a("ul",[a("li",[t._v("缓存一份停留时长数据（不上报）至本地缓存")]),t._v(" "),a("li",[t._v("当前数据与页面离开时数据处理方式相同")])])]),t._v(" "),a("li",[t._v("切至后台\n"),a("ul",[a("li",[t._v("删除缓存的停留时长数据")]),t._v(" "),a("li",[t._v("当前数据与页面进入时数据处理方式相同")])])])])])]),t._v(" "),a("h4",{attrs:{id:"sdk配置埋点测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sdk配置埋点测试"}},[t._v("#")]),t._v(" sdk配置埋点测试")]),t._v(" "),a("ol",[a("li",[t._v("页面登录时，应将登录数据推送至父层页面")]),t._v(" "),a("li",[t._v("开启配置模式时（重置时），应查询当前页面已埋点信息，推送至父层页面")]),t._v(" "),a("li",[t._v("选中埋点时，应将埋点信息推送至父层页面")])])])}),[],!1,null,null,null);e.default=s.exports}}]);