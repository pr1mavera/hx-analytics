(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{289:function(v,t,e){"use strict";e.r(t);var _=e(0),s=Object(_.a)({},(function(){var v=this,t=v.$createElement,e=v._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[e("h2",{attrs:{id:"目录结构"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#目录结构"}},[v._v("#")]),v._v(" 目录结构")]),v._v(" "),e("ul",[e("li",[v._v("build/ ---- 项目编译配置")]),v._v(" "),e("li",[v._v("config/ ---- 应用配置（开发相关配置）")]),v._v(" "),e("li",[v._v("dist/ ---- 开发、生产脚本")]),v._v(" "),e("li",[v._v("docs/ ---- 文档")]),v._v(" "),e("li",[v._v("script/ ---- 编译相关shell")]),v._v(" "),e("li",[v._v("src/ ---- 源码\n"),e("ul",[e("li",[v._v("config/ ---- API主机配置")]),v._v(" "),e("li",[v._v("jssdk/ ---- jssdk相关逻辑\n"),e("ul",[e("li",[v._v("events/ ---- 浏览器环境基础事件监控")]),v._v(" "),e("li",[v._v("service/ ---- 浏览器环境服务API")]),v._v(" "),e("li",[v._v("HXAnalytics.ts ---- hx-analytics类")]),v._v(" "),e("li",[v._v("inversify.config.ts ---- IoC容器注册")]),v._v(" "),e("li",[v._v("types.ts ---- 容器字典")])])]),v._v(" "),e("li",[v._v("mode/ ---- 模式相关逻辑\n"),e("ul",[e("li",[v._v("browse/ ---- 浏览模式")]),v._v(" "),e("li",[v._v("report/ ---- 事件上报模式\n"),e("ul",[e("li",[v._v("middleware/ ---- 事件上报相关中间件")]),v._v(" "),e("li",[v._v("MsgsQueue.ts ---- 消息队列")]),v._v(" "),e("li",[v._v("PageTracer.ts ---- 页面停留时长监控")]),v._v(" "),e("li",[v._v("Report.ts ---- 事件上报集合")]),v._v(" "),e("li",[v._v("ReportStrategy.ts ---- 上报策略")])])]),v._v(" "),e("li",[v._v("setting/ ---- 埋点配置模式\n"),e("ul",[e("li",[v._v("CustomCanvas.ts ---- 自定义canvas构造器")]),v._v(" "),e("li",[v._v("DomMasker.ts ---- 埋点捕捉蒙板")]),v._v(" "),e("li",[v._v("Setting.ts ---- 埋点配置集合")])])])])]),v._v(" "),e("li",[v._v("typings/ ---- ts类型文件")]),v._v(" "),e("li",[v._v("utils/ ---- 公共类库\n"),e("ul",[e("li",[v._v("AppConfig.ts ---- 运行时系统相关配置，提供")]),v._v(" "),e("li",[v._v("EventSubscriber.ts ---- 事件注册中心")]),v._v(" "),e("li",[v._v("Point.ts ---- 埋点构造器")]),v._v(" "),e("li",[v._v("utils.ts ---- 公共函数库")])])]),v._v(" "),e("li",[v._v("entry-jssdk.ts ---- jssdk入口")])])])]),v._v(" "),e("h2",{attrs:{id:"依赖注入方式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#依赖注入方式"}},[v._v("#")]),v._v(" 依赖注入方式")]),v._v(" "),e("p",[v._v("项目依赖 typescript ，使用 "),e("a",{attrs:{href:"https://www.npmjs.com/package/inversify",target:"_blank",rel:"noopener noreferrer"}},[v._v("inversify"),e("OutboundLink")],1),v._v(" 实现依赖注入，开发时请遵循以下规则")]),v._v(" "),e("ul",[e("li",[v._v("所有业务相关抽象类之间应尽量保持无依赖关系")]),v._v(" "),e("li",[v._v("抽象类应先在 "),e("code",[v._v("src/inversify.config.ts")]),v._v(" 中注册至容器，再在业务逻辑中使用 "),e("code",[v._v("@inject")]),v._v(" 注入该依赖")])]),v._v(" "),e("h2",{attrs:{id:"基础类接口说明"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#基础类接口说明"}},[v._v("#")]),v._v(" 基础类接口说明")]),v._v(" "),e("h3",{attrs:{id:"hxanalytics"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#hxanalytics"}},[v._v("#")]),v._v(" HXAnalytics")]),v._v(" "),e("p",[v._v("sdk实例类，管理当前SDK状态及模式切换，同时是外界指令推送的入口")]),v._v(" "),e("h4",{attrs:{id:"private-mode"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#private-mode"}},[v._v("#")]),v._v(" "),e("code",[v._v("private")]),v._v(" _mode")]),v._v(" "),e("ul",[e("li",[e("code",[v._v("@desc")]),v._v(" - 当前活跃模式引用，每个模式都有自己的生命周期")]),v._v(" "),e("li",[e("em",[v._v("get")]),v._v(" mode\n"),e("ul",[e("li",[e("code",[v._v("@desc")]),v._v(" - 获取模式类型")]),v._v(" "),e("li",[e("code",[v._v("@return")]),v._v(" - 当前模式模式类型（字符串）")])])]),v._v(" "),e("li",[e("em",[v._v("set")]),v._v(" mode\n"),e("ul",[e("li",[e("code",[v._v("@desc")]),v._v(" - 设置模式类型，会退出上一个模式（onExit），并进入传入的模式（onEnter）")]),v._v(" "),e("li",[e("code",[v._v("@param")]),v._v(" modeType:string - 模式类型（字符串）")]),v._v(" "),e("li",[e("code",[v._v("@return")]),v._v(" - void")])])])]),v._v(" "),e("h4",{attrs:{id:"private-modecontainer"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#private-modecontainer"}},[v._v("#")]),v._v(" "),e("code",[v._v("private")]),v._v(" modeContainer")]),v._v(" "),e("ul",[e("li",[e("code",[v._v("@desc")]),v._v(" - 模式容器，设置当前模式的时候会根据模式字符串从该容器内获取对应模式")])]),v._v(" "),e("h4",{attrs:{id:"private-init"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#private-init"}},[v._v("#")]),v._v(" "),e("code",[v._v("private")]),v._v(" init")]),v._v(" "),e("ul",[e("li",[e("code",[v._v("@desc")]),v._v(" - 用户信息存贮及模式初始化")]),v._v(" "),e("li",[e("code",[v._v("@param")]),v._v(" user:string[] - 登录用户信息，参数顺序：appId, sysId, openId （保持与初始化指令一致）")])]),v._v(" "),e("h4",{attrs:{id:"push"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#push"}},[v._v("#")]),v._v(" push")]),v._v(" "),e("ul",[e("li",[e("code",[v._v("@desc")]),v._v(" - 主动事件指令推送（提供给接入sdk的开发人员）")]),v._v(" "),e("li",[e("code",[v._v("@param")]),v._v(" - 参数详见"),e("router-link",{attrs:{to:"/指令系统.html"}},[v._v("指令系统")])],1)]),v._v(" "),e("h3",{attrs:{id:"appconfig"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#appconfig"}},[v._v("#")]),v._v(" AppConfig")]),v._v(" "),e("p",[v._v("sdk层面的系统配置缓存，主要存贮一些系统信息、设备信息、用户信息"),e("br"),v._v("\n同时容器默认存在保留字段 "),e("code",[v._v("reportType1")]),v._v(" 和 "),e("code",[v._v("reportType2")]),v._v(" 用于定义数据上报时的报文字段，上报时会根据该数据组装自动组装")]),v._v(" "),e("h4",{attrs:{id:"get"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#get"}},[v._v("#")]),v._v(" get")]),v._v(" "),e("ul",[e("li",[e("code",[v._v("@param")]),v._v(" key:string - 可选，表示想要获取数据的索引值，若不传则表示获取整个数据对象")]),v._v(" "),e("li",[e("code",[v._v("@return")]),v._v(" any - 若传入的了 key ，则可能返回任意数据类型（不存在则为undefined），若传入了 key 则为 Object 类型")])]),v._v(" "),e("h4",{attrs:{id:"set"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#set"}},[v._v("#")]),v._v(" set")]),v._v(" "),e("ul",[e("li",[e("code",[v._v("@param")]),v._v(" key:string - 表示想要存贮的数据的索引，此处的清空会将数据集上的索引连同的清空掉"),e("br"),v._v("\n类似于 "),e("code",[v._v("delete xx")]),v._v(" 操作")]),v._v(" "),e("li",[e("code",[v._v("@return")]),v._v(" undefined")])]),v._v(" "),e("h4",{attrs:{id:"merge"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#merge"}},[v._v("#")]),v._v(" merge")]),v._v(" "),e("ul",[e("li",[e("code",[v._v("@decs")]),v._v(" - 用于合并一匹数据项")]),v._v(" "),e("li",[e("code",[v._v("@param")]),v._v(" data:object - 传入的数据项，若其中存在与源数据相同的属性，则会覆盖")])]),v._v(" "),e("h3",{attrs:{id:"eventsubscriber"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#eventsubscriber"}},[v._v("#")]),v._v(" EventSubscriber")]),v._v(" "),e("p",[v._v("事件监听中心，用于两个模式下的原生应用事件监听与注销，主要用于集中收集rx监听的原生事件返回的 "),e("code",[v._v("subscription")]),v._v(" 对象，在一定时机统一做注销监听（unsubscribe）的处理"),e("br"),v._v("\n同时提供额外的自定义事件监听接口（目前只实现了单一回调，按道理来说应该是提供一个回调队列的😌）")]),v._v(" "),e("h4",{attrs:{id:"private-ctx-t"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#private-ctx-t"}},[v._v("#")]),v._v(" "),e("code",[v._v("private")]),v._v(" ctx:T")]),v._v(" "),e("ul",[e("li",[e("code",[v._v("@desc")]),v._v(" - 事件监听器所在的当前上下文")])]),v._v(" "),e("h4",{attrs:{id:"private-subs-subscription"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#private-subs-subscription"}},[v._v("#")]),v._v(" "),e("code",[v._v("private")]),v._v(" subs:Subscription[]")]),v._v(" "),e("ul",[e("li",[e("code",[v._v("@desc")]),v._v(" - rx 的 "),e("code",[v._v("subscribe")]),v._v(" 接口注册的 "),e("code",[v._v("subscription")]),v._v(" 队列")])]),v._v(" "),e("h4",{attrs:{id:"init"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#init"}},[v._v("#")]),v._v(" init")]),v._v(" "),e("ul",[e("li",[e("code",[v._v("@desc")]),v._v(" - 事件监听中心初始化")]),v._v(" "),e("li",[e("code",[v._v("@param")]),v._v(" ctx:T - 挂载的上下文")]),v._v(" "),e("li",[e("code",[v._v("@return")]),v._v(" EventSubscriber")])]),v._v(" "),e("h4",{attrs:{id:"subscribe"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#subscribe"}},[v._v("#")]),v._v(" subscribe")]),v._v(" "),e("ul",[e("li",[e("code",[v._v("@desc")]),v._v(" - 将 ctx 上以 "),e("code",[v._v("模式")]),v._v(" + "),e("code",[v._v("-")]),v._v(" 开头的属性（如 "),e("code",[v._v("report-click")]),v._v("）作为需要添加的监听，执行 callback 并将返回值 push 到 subs 中")])]),v._v(" "),e("h4",{attrs:{id:"unsubscribe"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#unsubscribe"}},[v._v("#")]),v._v(" unsubscribe")]),v._v(" "),e("ul",[e("li",[e("code",[v._v("@desc")]),v._v(" - 将 subscribe 接口添加的所有事件监听取消注册")])]),v._v(" "),e("h4",{attrs:{id:"on"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#on"}},[v._v("#")]),v._v(" on")]),v._v(" "),e("ul",[e("li",[e("code",[v._v("@desc")]),v._v(" - 单独注册额外的自定义事件")]),v._v(" "),e("li",[e("code",[v._v("@param")]),v._v(" event:string - 事件名称")]),v._v(" "),e("li",[e("code",[v._v("@param")]),v._v(" sub:Subscription - 事件回调执行后返回的 Subscription 实例")])]),v._v(" "),e("h4",{attrs:{id:"off"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#off"}},[v._v("#")]),v._v(" off")]),v._v(" "),e("ul",[e("li",[e("code",[v._v("@desc")]),v._v(" - 将单独注册额外的自定义事件监听注销")]),v._v(" "),e("li",[e("code",[v._v("@param")]),v._v(" event:string - 事件名称")])]),v._v(" "),e("h3",{attrs:{id:"point"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#point"}},[v._v("#")]),v._v(" Point")]),v._v(" "),e("p",[v._v("对应页面上一个元素节点的工厂类")]),v._v(" "),e("h4",{attrs:{id:"pid-string"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#pid-string"}},[v._v("#")]),v._v(" pid:string")]),v._v(" "),e("ul",[e("li",[e("code",[v._v("@desc")]),v._v(" - 元素唯一标识，将在哈希后作为 funcId 上报")])]),v._v(" "),e("h4",{attrs:{id:"tag-string"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#tag-string"}},[v._v("#")]),v._v(" tag:string")]),v._v(" "),e("ul",[e("li",[e("code",[v._v("@desc")]),v._v(" - 元素的标签名称")])]),v._v(" "),e("h4",{attrs:{id:"rect-number"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#rect-number"}},[v._v("#")]),v._v(" rect:number[]")]),v._v(" "),e("ul",[e("li",[e("code",[v._v("@desc")]),v._v(" - 元素的位置大小信息，分别为 "),e("code",[v._v("[ x: 横坐标, y: 纵坐标, w: 宽, h: 高 ]")])])]),v._v(" "),e("h4",{attrs:{id:"create"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#create"}},[v._v("#")]),v._v(" create")]),v._v(" "),e("ul",[e("li",[e("code",[v._v("@desc")]),v._v(" - 元素初始化工厂，可根据传入的起始信息不同分别调用内部不同的API，最终生成一致的符合参数标准的 Point 实例")]),v._v(" "),e("li",[e("code",[v._v("@param")]),v._v(" origin:PointBase | EventTarget - 元素起始来源（可能是之前就生成过 pid 的 PointBase 类型，也可能是来自页面元素节点）")]),v._v(" "),e("li",[e("code",[v._v("@return")]),v._v(" Point")])]),v._v(" "),e("h4",{attrs:{id:"private-createbypointbase"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#private-createbypointbase"}},[v._v("#")]),v._v(" "),e("code",[v._v("private")]),v._v(" createByPointBase")]),v._v(" "),e("ul",[e("li",[e("code",[v._v("@desc")]),v._v(" - 根据之前就生成过 pid 的 PointBase 创建元素")]),v._v(" "),e("li",[e("code",[v._v("@param")]),v._v(" origin:PointBase")])]),v._v(" "),e("h4",{attrs:{id:"private-createbyevent"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#private-createbyevent"}},[v._v("#")]),v._v(" "),e("code",[v._v("private")]),v._v(" createByEvent")]),v._v(" "),e("ul",[e("li",[e("code",[v._v("@desc")]),v._v(" - 根据来自页面元素节点创建元素")]),v._v(" "),e("li",[e("code",[v._v("@param")]),v._v(" origin:EventTarget")])])])}),[],!1,null,null,null);t.default=s.exports}}]);