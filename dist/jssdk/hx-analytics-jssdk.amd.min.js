/*!
 * hx-analytics jssdk v1.0.0
 * (c) 2018-2019
 * author: pr1mavera
 * email: pr1mavera.w4ng@gmail.com
 */
define((function(){"use strict";function t(r){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(r)}function r(t,r){for(var n=0;n<r.length;n++){var e=r[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function n(t,r){return function(t){if(Array.isArray(t))return t}(t)||function(t,r){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var n=[],e=!0,o=!1,i=void 0;try{for(var s,u=t[Symbol.iterator]();!(e=(s=u.next()).done)&&(n.push(s.value),!r||n.length!==r);e=!0);}catch(t){o=!0,i=t}finally{try{e||null==u.return||u.return()}finally{if(o)throw i}}return n}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function e(){}e.inIframe=function(){return window&&window.self!==window.top},e.isType=function(t,r){return Object.prototype.toString.call(r)==="[object ".concat(t,"]")},e.createVisitId=function(t){return""+t+this.formatDate("yyyy-MM-dd-hh-mm-ss").split(/-/g).join("")+this.randomInRange(1e5,999999)},e.formatDate=function(t){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Date,n={M:r.getMonth()+1,d:r.getDate(),h:r.getHours(),m:r.getMinutes(),s:r.getSeconds(),q:Math.floor((r.getMonth()+3)/3)};return t.replace(/([yMdhmsqS])+/g,(function(t,e){var o=n[e];if(void 0!==o)return 1<t.length&&(o=(o="0"+o).substr(o.length-2)),o;if("y"===e)return(r.getFullYear()+"").substr(4-t.length);if("S"!==e)return t;var i="00".concat(r.getMilliseconds());return i.substr(i.length-3)}))},e.randomInRange=function(t,r){return Math.floor(Math.random()*(r-t)+t)},e.mixins=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return function(t){Object.assign.apply(Object,[t.prototype].concat(r))}};var o=function(){function t(t){this.modeType="setting",this.events=t}var r=t.prototype;return r.reset=function(){},r.onEnter=function(){},r.onCatch=function(){},r.onExit=function(){},r.onTrigger=function(){console.log("SettingLifeCycle onTrigger")},t}(),i=function(t,r){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])})(t,r)};function s(t,r){function n(){this.constructor=t}i(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}function u(t){return"function"==typeof t}var c=!1,a={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){t&&(new Error).stack,c=t},get useDeprecatedSynchronousErrorHandling(){return c}};function f(t){setTimeout((function(){throw t}),0)}var h={closed:!0,next:function(t){},error:function(t){if(a.useDeprecatedSynchronousErrorHandling)throw t;f(t)},complete:function(){}},p=Array.isArray||function(t){return t&&"number"==typeof t.length},l=function(){function t(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(t,r){return r+1+") "+t.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t}(),b=function(){function t(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}var r;return t.prototype.unsubscribe=function(){var r;if(!this.closed){var n,e=this._parentOrParents,o=this._unsubscribe,i=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,e instanceof t)e.remove(this);else if(null!==e)for(var s=0;s<e.length;++s)e[s].remove(this);if(u(o))try{o.call(this)}catch(n){r=n instanceof l?y(n.errors):[n]}if(p(i)){s=-1;for(var c=i.length;++s<c;){var a=i[s];if(null!==(n=a)&&"object"==typeof n)try{a.unsubscribe()}catch(n){r=r||[],n instanceof l?r=r.concat(y(n.errors)):r.push(n)}}}if(r)throw new l(r)}},t.prototype.add=function(r){var n=r;if(!r)return t.EMPTY;switch(typeof r){case"function":n=new t(r);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof t)){var e=n;(n=new t)._subscriptions=[e]}break;default:throw new Error("unrecognized teardown "+r+" added to Subscription.")}var o=n._parentOrParents;if(null===o)n._parentOrParents=this;else if(o instanceof t){if(o===this)return n;n._parentOrParents=[o,this]}else{if(-1!==o.indexOf(this))return n;o.push(this)}var i=this._subscriptions;return null===i?this._subscriptions=[n]:i.push(n),n},t.prototype.remove=function(t){var r=this._subscriptions;if(r){var n=r.indexOf(t);-1!==n&&r.splice(n,1)}},t.EMPTY=((r=new t).closed=!0,r),t}();function y(t){return t.reduce((function(t,r){return t.concat(r instanceof l?r.errors:r)}),[])}var d="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),v=function(t){function r(n,e,o){var i=t.call(this)||this;switch(i.syncErrorValue=null,i.syncErrorThrown=!1,i.syncErrorThrowable=!1,i.isStopped=!1,arguments.length){case 0:i.destination=h;break;case 1:if(!n){i.destination=h;break}if("object"==typeof n){n instanceof r?(i.syncErrorThrowable=n.syncErrorThrowable,(i.destination=n).add(i)):(i.syncErrorThrowable=!0,i.destination=new g(i,n));break}default:i.syncErrorThrowable=!0,i.destination=new g(i,n,e,o)}return i}return s(r,t),r.prototype[d]=function(){return this},r.create=function(t,n,e){var o=new r(t,n,e);return o.syncErrorThrowable=!1,o},r.prototype.next=function(t){this.isStopped||this._next(t)},r.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},r.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},r.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},r.prototype._next=function(t){this.destination.next(t)},r.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},r.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},r.prototype._unsubscribeAndRecycle=function(){var t=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this},r}(b),g=function(t){function r(r,n,e,o){var i,s=t.call(this)||this;s._parentSubscriber=r;var c=s;return u(n)?i=n:n&&(i=n.next,e=n.error,o=n.complete,n!==h&&(u((c=Object.create(n)).unsubscribe)&&s.add(c.unsubscribe.bind(c)),c.unsubscribe=s.unsubscribe.bind(s))),s._context=c,s._next=i,s._error=e,s._complete=o,s}return s(r,t),r.prototype.next=function(t){if(!this.isStopped&&this._next){var r=this._parentSubscriber;a.useDeprecatedSynchronousErrorHandling&&r.syncErrorThrowable?this.__tryOrSetError(r,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},r.prototype.error=function(t){if(!this.isStopped){var r=this._parentSubscriber,n=a.useDeprecatedSynchronousErrorHandling;if(this._error)n&&r.syncErrorThrowable?this.__tryOrSetError(r,this._error,t):this.__tryOrUnsub(this._error,t),this.unsubscribe();else if(r.syncErrorThrowable)n?(r.syncErrorValue=t,r.syncErrorThrown=!0):f(t),this.unsubscribe();else{if(this.unsubscribe(),n)throw t;f(t)}}},r.prototype.complete=function(){var t=this;if(!this.isStopped){var r=this._parentSubscriber;if(this._complete){var n=function(){return t._complete.call(t._context)};a.useDeprecatedSynchronousErrorHandling&&r.syncErrorThrowable?this.__tryOrSetError(r,n):this.__tryOrUnsub(n),this.unsubscribe()}else this.unsubscribe()}},r.prototype.__tryOrUnsub=function(t,r){try{t.call(this._context,r)}catch(t){if(this.unsubscribe(),a.useDeprecatedSynchronousErrorHandling)throw t;f(t)}},r.prototype.__tryOrSetError=function(t,r,n){if(!a.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{r.call(this._context,n)}catch(r){return a.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=r,t.syncErrorThrown=!0):(f(r),!0)}return!1},r.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},r}(v),m="function"==typeof Symbol&&Symbol.observable||"@@observable";function _(){}var w=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(r){var n=new t;return n.source=this,n.operator=r,n},t.prototype.subscribe=function(t,r,n){var e=this.operator,o=function(t,r,n){if(t){if(t instanceof v)return t;if(t[d])return t[d]()}return t||r||n?new v(t,r,n):new v(h)}(t,r,n);if(e?o.add(e.call(o,this.source)):o.add(this.source||a.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),a.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(r){a.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=r),function(t){for(;t;){var r=t,n=r.closed,e=r.destination,o=r.isStopped;if(n||o)return!1;t=e&&e instanceof v?e:null}return!0}(t)?t.error(r):console.warn(r)}},t.prototype.forEach=function(t,r){var n=this;return new(r=E(r))((function(r,e){var o;o=n.subscribe((function(r){try{t(r)}catch(r){e(r),o&&o.unsubscribe()}}),e,r)}))},t.prototype._subscribe=function(t){var r=this.source;return r&&r.subscribe(t)},t.prototype[m]=function(){return this},t.prototype.pipe=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return 0===t.length?this:function(t){return t?1===t.length?t[0]:function(r){return t.reduce((function(t,r){return r(t)}),r)}:_}(t)(this)},t.prototype.toPromise=function(t){var r=this;return new(t=E(t))((function(t,n){var e;r.subscribe((function(t){return e=t}),(function(t){return n(t)}),(function(){return t(e)}))}))},t.create=function(r){return new t(r)},t}();function E(t){if(!(t=t||Promise))throw new Error("no Promise impl found");return t}var S=function(){function t(t,r){this.project=t,this.thisArg=r}return t.prototype.call=function(t,r){return r.subscribe(new O(t,this.project,this.thisArg))},t}(),O=function(t){function r(r,n,e){var o=t.call(this,r)||this;return o.project=n,o.count=0,o.thisArg=e||o,o}return s(r,t),r.prototype._next=function(t){var r;try{r=this.project.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}this.destination.next(r)},r}(v);function T(t,r,n,e){return u(n)&&(e=n,n=void 0),e?T(t,r,n).pipe(function(t,r){return function(r){return r.lift(new S(t,void 0))}}((function(t){return p(t)?e.apply(void 0,t):e(t)}))):new w((function(e){!function t(r,n,e,o,i){var s,u,c,a;if((a=r)&&"function"==typeof a.addEventListener&&"function"==typeof a.removeEventListener){var f=r;r.addEventListener(n,e,i),s=function(){return f.removeEventListener(n,e,i)}}else if((c=r)&&"function"==typeof c.on&&"function"==typeof c.off){var h=r;r.on(n,e),s=function(){return h.off(n,e)}}else if((u=r)&&"function"==typeof u.addListener&&"function"==typeof u.removeListener){var p=r;r.addListener(n,e),s=function(){return p.removeListener(n,e)}}else{if(!r||!r.length)throw new TypeError("Invalid event target");for(var l=0,b=r.length;l<b;l++)t(r[l],n,e,o,i)}o.add(s)}(t,r,(function(t){1<arguments.length?e.next(Array.prototype.slice.call(arguments)):e.next(t)}),e,n)}))}var x={"e-click":[{capture:!1},function(t){return this.events.click(t).subscribe((function(t){console.log("\u4e0a\u62a5\u6a21\u5f0f\u7684\u70b9\u51fb\uff1a",t)}))}]},j={subs:[b],subscribe:function(t){for(var r in console.log(t),t)if(/e-.+/g.test(r)){var e=n(t[r],2),o=e[0],i=e[1];this.subs.push(i.call(this,o))}},unSubscribe:function(){this.subs.length&&this.subs.forEach((function(t){return t.unsubscribe()})),this.subs=[]}},P=function(){function t(t){this.modeType="report",this.events=t}var r=t.prototype;return r.onEnter=function(){this.subscribe(this)},r.onExit=function(){this.unSubscribe()},r.onTrigger=function(){console.log("ReportLifeCycle onTrigger")},r.formatDatagram=function(){},t}();P=function(r,n,e,o){var i,s=arguments.length,u=s<3?n:null===o?o=Object.getOwnPropertyDescriptor(n,e):o;if("object"===("undefined"==typeof Reflect?"undefined":t(Reflect))&&"function"==typeof Reflect.decorate)u=Reflect.decorate(r,n,e,o);else for(var c=r.length-1;0<=c;c--)(i=r[c])&&(u=(s<3?i(u):3<s?i(n,e,u):i(n,e))||u);return 3<s&&u&&Object.defineProperty(n,e,u),u}([e.mixins(j,x)],P);var D=Object.freeze({click:function(t){return T(document,"click",t)},mousemove:function(t){return T(document,"mousemove",t)},load:function(){return T(document,"load")},beforeUnload:function(){return T(document,"beforeunload")},hashchange:function(){return T(document,"hashchange")},popstate:function(){return T(document,"popstate")},visibilitychange:function(){return T(document,"visibilitychange")},online:function(){return T(document,"online")},offline:function(){return T(document,"offline")},message:function(){return T(document,"message")}});return new(function(){function t(t){var r=t.mode;this.modeContainer=r,this.mode=e.inIframe()?"setting":"report"}var n=t.prototype;return n.push=function(){this._mode.onTrigger()},n.init=function(){return this},function(t,n,e){n&&r(t.prototype,n)}(t,[{key:"mode",get:function(){return this._mode.modeType},set:function(t){this._mode=this.modeContainer[t],this._mode.onEnter()}}]),t}())({mode:{report:new P(D),setting:new o(D)}})}));